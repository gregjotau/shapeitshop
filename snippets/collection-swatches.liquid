{% comment %}
  Renders color swatches for product variants in collection views
  Accepts:
  - product: {Object} Product Liquid object (required)

  Usage:
  {% render 'collection-swatches', product: product %}
{% endcomment %}

{% style %}
    .product_tile_color_holder {
    display: flex;
    gap: 5px;
    margin-top: 10px;
    }

    input[type=radio][name$=_card_color] {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    border: 1px solid black;
    appearance: none;
    cursor: pointer;
    transition: all 0.3s ease;
    }

    input[type=radio][name$=_card_color]:hover {
    transform: scale(1.1);
    }

    input[type=radio][name$=_card_color]:checked {
    border: 2px solid #000;
    box-shadow: 0 0 0 2px #fff inset;
    }

    input[type=radio][name$=_card_color]:not([style*="background:"]) {
    background-size: 9px 9px;
    background-image: repeating-linear-gradient(45deg, #000 0, #000 1px, #ebebeb 0, #ebebeb 50%);
    }
{% endstyle %}

{% assign keys = "Color,color,Colour,colour" | split: ',' %}
{% for key in keys %}
    {% if product.options contains key %}
        <div class="product_tile_color_holder">
            {% for color_option in product.options_by_name[key].values %}
                {% for variant in product.variants %}
                    {% if variant.options contains color_option %}
                        {% assign background_style = color_option %}
                        {% if variant.metafields.color.values %}
                            {% assign background_style = variant.metafields.color.values %}
                        {% endif %}
                        {% if variant.metafields.image.values %}
                            {% assign background_style = "url(" | append: variant.metafields.image.swatch | append: ")" %}
                        {% endif %}
                        <a href="{{ product.url }}?variant={{ variant.id }}" title="{{ color_option | escape }}">
                            <input
                                    type="radio"
                                    name="{{ product.id }}_card_color"
                                    id="{{ product.id }}_color_{{ forloop.index }}"
                                    style="background: {{ background_style }}; background-size: cover;">
                        </a>
                        {% break %}
                    {% endif %}
                {% endfor %}
            {% endfor %}
        </div>
        {% break %}
    {% endif %}
{% endfor %}